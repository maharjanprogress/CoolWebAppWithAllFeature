<div class="container">
  <h2>Upload Trial Balance Files</h2>
  <p class="subtitle">Upload your Trial Balance, Profit & Loss, and Balance Sheet files (.xlsx or .xls).</p>

  <!-- Upload interface -->
  <div class="upload-section" *ngIf="!isProcessing">

    <div class="file-upload-group">
      <label>Trial Balance</label>
      <app-file-upload #trialBalanceUpload
                       [onlyInclude]="allowedFileTypes"
                       [singleFile]="true">
      </app-file-upload>
    </div>

    <div class="file-upload-group">
      <label>Profit & Loss</label>
      <app-file-upload #profitAndLossUpload
                       [onlyInclude]="allowedFileTypes"
                       [singleFile]="true">
      </app-file-upload>
    </div>

    <div class="file-upload-group">
      <label>Balance Sheet</label>
      <app-file-upload #balanceSheetUpload
                       [onlyInclude]="allowedFileTypes"
                       [singleFile]="true">
      </app-file-upload>
    </div>

    <button class="upload-btn" (click)="uploadFile()" [disabled]="uploading">
      {{ uploading ? 'Uploading...' : 'Upload and Process' }}
    </button>
  </div>

  <!-- Processing Log View -->
  <div class="processing-section" *ngIf="isProcessing">
    <h3>Processing Log</h3>
    <p class="log-message">{{ currentMessage }}</p>
    <div class="progress-bar"><div class="progress-fill" [style.width.%]="currentProgress"></div></div>
    <p class="progress-text">{{ currentProgress }}% Complete</p>
  </div>

  <!-- Results View -->
  <div class="results-section" *ngIf="excelDownloadUrl || powerpointDownloadUrl">
    <h3>Results</h3>
    <div class="download-buttons">
      <a *ngIf="excelDownloadUrl" [href]="excelDownloadUrl" class="download-btn excel" target="_blank" download>
        <img src="icons/excel.svg" alt="Excel Icon"> Download Excel
      </a>
      <a *ngIf="powerpointDownloadUrl" [href]="powerpointDownloadUrl" class="download-btn powerpoint" target="_blank" download>
        <img src="icons/powerpoint.svg" alt="PowerPoint Icon"> Download PowerPoint
      </a>
    </div>
  </div>
</div>
